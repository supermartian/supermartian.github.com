<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" media="screen" />
<style type="text/css">
.main-container {
    margin:0 auto;
    width: 900px;
}
.main-content {
    width: 900px;
    margin:0 auto;
}
.sticker {
    width: 100px;
    height: 100px;
}
.footer {
    text-align: center;
    padding: 30px 0;
    margin-top: 70px;
    border-top: 1px solid #e5e5e5;
    background-color: #f5f5f5;
}
</style>
<script type="text/javascript" src="lib/js/jquery.js"></script>
<script type="text/javascript" src="lib/js/markdown.js"></script>
<script type="text/javascript">
function goPost(url) {
    $.get(url, function(data){
        $("#content").html(markdown.toHTML(data));
    }, 'html');
}
$(function(){
    function getPosts(catagory) {
        var catagory_post_json = "posts/" + catagory + "/list.json";
        $.getJSON(catagory_post_json, function(data) {
            var list_cata_html = new Array();
            $.each(data.posts, function(item){
                var name = data.posts[item].name;
                var url = data.posts[item].url;
                var date = data.posts[item].date;
                list_cata_html.push("<li><a href=\"#\" onClick=\"goPost('"+ url +"')\">" + name + "</a></li>");
            });
            $("#content_list").append(list_cata_html.join(""));
        });
    }

    $.getJSON('data/catagory.json', function(data) {
        var list_html = new Array();
        var post_list_html = new Array();
        $.each(data.catagory, function(item){
            var name = data.catagory[item].name;
            var url = data.catagory[item].url;
            list_html.push("<li><a href=\"#\" onClick=\"goCatagory('"+ url +"')\">" + name + "</a></li>");
            getPosts(name);
        });
        $("#catagory_list").append(list_html.join(""));
    });
});
</script>
</head>
<body>
<div class="main-container">
    <div class="navbar">
        <div class="container">
        <div class="navbar-inner">
        <a class="brand" href="index.html">Martian Workshop</a>
        <ul class="nav pull-right">
            <li><a href="#">About Me</a></li>
        </ul>
        </div>
        </div>
    </div>
    <div class="row main-content">
    <div class="span4 sticker">
        <img src="https://secure.gravatar.com/avatar/fb83b522e2fd3f1df774d3a8d702db99?s=420&d=https://a248.e.akamai.net/assets.github.com%2Fimages%2Fgravatars%2Fgravatar-user-420.png"></img>
    </div>
    <div class="span8">
    <div id="content" class="span6">
        <h3>Posts:</h3>
        <ul id="content_list">
        </ul>
    </div>
    <div id="catagory" class="span6">
        <h3>Catagories:</h3>
        <ul id="catagory_list">
        </ul>
    </div>
    </div>
    </div>
    <div class="footer">Martian Workshop @ 2013</div>
</div>
</body>
</html>
